webpackJsonp([5],{"+Pg4":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("lC5x"),n=a.n(s),i=a("J0Oq"),r=a.n(i),l=a("gyMJ"),o=a("CtzY"),c=a.n(o),m={data:function(){return{postTime:"",formLabelAlign:{messageId:"",content:""},item:{messageId:"",content:""},tableData:[],total:0,pageSize:20,pageNum:1,dialogVisible:!1,title:"消息新增"}},mixins:[a("KHRU").a],mounted:function(){this.messageList()},methods:{messageList:function(e){var t=this;return r()(n.a.mark(function a(){var s,i;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e=e||"",a.next=3,l.a.messageList({pageNum:t.pageNum,pageSize:t.pageSize,postTime:e});case 3:200===(s=a.sent).code?(t.tableData=s.data.list,t.total=s.data.total,i=t.tableData.filter(function(e){return 0===e.state}),t.$nextTick(function(){for(var e=0;e<i.length;e++)t.$refs.table.toggleRowSelection(i[e],!0)})):904===s.code&&(t.tableData=[],t.total=1,t.$message({message:s.message,type:"warning"}));case 5:case"end":return a.stop()}},a,t)}))()},resetForm:function(){this.dialogVisible=!1},searchSubmit:function(){this.pageNum=1,this.messageList(this.postTime)},onSubmit:function(){this.dialogVisible=!0,this.formLabelAlign=this.item,this.title="消息新增"},checkBtn:function(e){this.messageDetails(e),this.title="消息修改"},messageDetails:function(e){var t=this;return r()(n.a.mark(function a(){var s;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,l.a.messageDetails(e);case 2:200===(s=a.sent).code?(t.formLabelAlign=s.data,t.dialogVisible=!0):t.$message({type:"warning",message:s.message});case 4:case"end":return a.stop()}},a,t)}))()},submitForm:function(){if(""===this.formLabelAlign.content||null==this.formLabelAlign.content)return this.$message({message:"请填写推送消息",type:"warning"}),!1;this.addMessage()},addMessage:function(){var e=this;return r()(n.a.mark(function t(){var a;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=void 0,""!==e.formLabelAlign.messageId){t.next=7;break}return t.next=4,l.a.addMessage({content:e.formLabelAlign.content});case 4:a=t.sent,t.next=10;break;case 7:return t.next=9,l.a.updateMessage(e.formLabelAlign);case 9:a=t.sent;case 10:200===a.code?(e.messageList(),e.$message({message:a.data.msg,type:"success"}),e.dialogVisible=!1):e.$message({type:"warning",message:a.message});case 11:case"end":return t.stop()}},t,e)}))()},handleSizeChange:function(e){this.pageSize=e,this.messageList()},handleCurrentChange:function(e){this.pageNum=e,this.messageList()},handleClose:function(){},handleChange:function(e,t){this.$refs.table.clearSelection(),this.$refs.table.toggleRowSelection(t),this.release(t.messageId,e)},release:function(e,t){var a=this;return r()(n.a.mark(function s(){var i;return n.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,l.a.release(c.a.stringify({messageId:e}));case 2:200===(i=s.sent).code?a.messageList():(a.$message({type:"warning",message:i.message}),a.$refs.table.toggleRowSelection(t.pop()));case 4:case"end":return s.stop()}},s,a)}))()},deleteBtn:function(e){var t=this;this.$confirm("是否删除该项目","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"primary"}).then(function(){t.deleteMessage(e)}).catch(function(){t.$message({type:"warning",message:"已取消删除"})})},deleteMessage:function(e){var t=this;return r()(n.a.mark(function a(){var s;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,l.a.deleteMessage(c.a.stringify({messageId:e}));case 2:200===(s=a.sent).code?(t.messageList(),t.$message({type:"success",message:"删除成功!"})):t.$message({message:s.message,type:"warning"});case 4:case"end":return a.stop()}},a,t)}))()}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"helpFul"},[a("div",[a("div",[[a("header",[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"发布时间"}},[a("el-input",{attrs:{placeholder:"发布时间"},model:{value:e.postTime,callback:function(t){e.postTime=t},expression:"postTime"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.searchSubmit}},[e._v("查询")])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("新增栏目")])],1)],1)],1)],e._v(" "),[a("section",[a("el-table",{ref:"table",staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.tableData,border:""},on:{select:e.handleChange}},[a("el-table-column",{attrs:{type:"selection",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{type:"index",label:"序号",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"content",label:"推送内容","min-width":"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"postTime",label:"发布时间","min-width":"120"}}),e._v(" "),a("el-table-column",{staticClass:"make",attrs:{label:"发布状态","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.state?a("span",[e._v("发布中")]):a("span",[e._v("发布结束")])]}}])}),e._v(" "),a("el-table-column",{staticClass:"make",attrs:{label:"操作","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.checkBtn(t.row.messageId)}}},[e._v("编辑")]),e._v(" "),a("el-button",{staticStyle:{color:"red"},attrs:{type:"text",size:"small"},on:{click:function(a){return e.deleteBtn(t.row.messageId)}}},[e._v("删除")])]}}])})],1)],1)]],2),e._v(" "),[a("footer",[a("div",[a("el-pagination",{attrs:{"current-page":e.pageNum,"page-sizes":[5,10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])]],2),e._v(" "),a("el-dialog",{staticClass:"welfare",attrs:{visible:e.dialogVisible,width:"80%",title:e.title},on:{"update:visible":function(t){e.dialogVisible=t},close:e.handleClose}},[[a("el-form",{attrs:{"label-position":"left","label-width":"100px",model:e.formLabelAlign}},[a("el-form-item",{attrs:{label:"消息推送"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:6,maxRows:10}},model:{value:e.formLabelAlign.content,callback:function(t){e.$set(e.formLabelAlign,"content","string"==typeof t?t.trim():t)},expression:"formLabelAlign.content"}})],1),e._v(" "),a("el-form-item",[a("el-button",{on:{click:e.resetForm}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("保存")])],1)],1)]],2)],1)},staticRenderFns:[]};var g=a("C7Lr")(m,u,!1,function(e){a("3lsN"),a("B4kF")},"data-v-333a6d54",null);t.default=g.exports},"3lsN":function(e,t){},B4kF:function(e,t){}});
//# sourceMappingURL=5.208bbf68db391d215837.js.map