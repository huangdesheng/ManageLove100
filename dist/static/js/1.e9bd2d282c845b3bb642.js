webpackJsonp([1],{IHPB:function(e,t,a){"use strict";t.__esModule=!0;var n,i=a("kfHR"),r=(n=i)&&n.__esModule?n:{default:n};t.default=function(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return(0,r.default)(e)}},PtTQ:function(e,t){},SgPA:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("lC5x"),i=a.n(n),r=a("IHPB"),s=a.n(r),l=a("kfHR"),o=a.n(l),c=a("J0Oq"),u=a.n(c),m=a("gyMJ"),f=a("CtzY"),g=a.n(f),p=a("nm5P"),d=a("KHRU"),b={data:function(){return{formInline:{payNumber:"-1",name:""},formLabelAlign:{name:"",region:"",type:"",explain:"",imgs:[],title:"",implementation:"",introduce:"",projectBudget:"",targetAmount:"",budgetPhoto:""},formLabelAlignOne:{name:"",region:"",type:"",explain:"",imgs:[],title:"",implementation:"",introduce:"",projectBudget:"",targetAmount:"",budgetPhoto:""},saveStatus:[{payName:"全部",payNumber:"-1"},{payName:"未发布",payNumber:"2"},{payName:"筹款中",payNumber:"0"},{payName:"已结束",payNumber:"1"}],tableData:[],checkData:[],total:0,pageSize:20,pageNum:1,dialogVisible:!1,icon:a("BxgL"),no_icon:a("j7d7"),imageUrl:"",dialogVisiblePic:!1,dialogImageUrl:"",disabled:!1,title:""}},mixins:[p.a,d.a],mounted:function(){this.welfareList()},computed:{list:function(){return this.$store.state.menusLists}},methods:{onSubmit:function(){this.pageNum=1,this.welfareList(this.formInline.name)},addSubmit:function(){this.title="新增公益",this.dialogVisible=!0,this.formLabelAlign=this.formLabelAlignOne},resetForm:function(){this.dialogVisible=!1},fileChange:function(e){this.moreUpload(e)},moreUpload:function(e){var t=this;return u()(i.a.mark(function a(){var n,r,l,c,u,f,g;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(n=o()(e.target.files),r=new FormData,!(n.length>3||t.formLabelAlign.imgs.length>2||t.formLabelAlign.imgs.length+n.length>3)){a.next=5;break}return alert("超过上传数量"),a.abrupt("return",!1);case 5:for(l=0;l<n.length;l++)c=n[l],r.append("files",c);return u={"Content-Type":"multipart/form-data"},a.next=9,m.a.moreUploadTwo(r,u);case 9:200===(f=a.sent).code&&(document.getElementById("upload_file").value="",g=[],f.data.forEach(function(e){g.push(e.photoUrl)}),t.formLabelAlign.imgs=[].concat(s()(t.formLabelAlign.imgs),g));case 11:case"end":return a.stop()}},a,t)}))()},singleFileChange:function(e){var t=this;return u()(i.a.mark(function a(){var n,r,s;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return(n=new FormData).append("file",e.srcElement.files[0]),r={"Content-Type":"multipart/form-data"},a.next=5,m.a.singleUpload(n,r);case 5:200===(s=a.sent).code?t.formLabelAlign.budgetPhoto=s.data.photoUrl:t.$message({message:s.message,type:"warning"});case 7:case"end":return a.stop()}},a,t)}))()},deleteImg:function(e,t){this.deletePic(e,t)},deletePic:function(e,t){var a=this;return u()(i.a.mark(function n(){return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,m.a.deletePic({obj:t});case 2:200===n.sent.code&&(a.$message({message:"删除图片成功"}),a.formLabelAlign.imgs.splice(e,1),document.getElementById("upload_file").value="");case 4:case"end":return n.stop()}},n,a)}))()},submitForm:function(){return""===this.formLabelAlign.title||null===this.formLabelAlign.title?(this.$message({type:"warning",message:"项目名称不能为空"}),!1):""===this.formLabelAlign.targetAmount||null===this.formLabelAlign.targetAmount?(this.$message({type:"warning",message:"目标金额不能为空"}),!1):""===this.formLabelAlign.introduce||null===this.formLabelAlign.introduce?(this.$message({type:"warning",message:"活动形式不能为空"}),!1):0===this.formLabelAlign.imgs.length?(this.$message({type:"warning",message:"项目图片不能为空"}),!1):""===this.formLabelAlign.projectBudget||null===this.formLabelAlign.projectBudget?(this.$message({type:"warning",message:"项目预算不能为空"}),!1):""===this.formLabelAlign.explain||null===this.formLabelAlign.explain?(this.$message({type:"warning",message:"管理费说明不能为空"}),!1):""===this.formLabelAlign.implementation||null===this.formLabelAlign.implementation?(this.$message({type:"warning",message:"执行计划不能为空"}),!1):void(void 0!=this.formLabelAlign.projectId?this.editWelfare(this.formLabelAlign):this.addWelfare(this.formLabelAlign))},addWelfare:function(){var e=this;return u()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.addWelfare(e.formLabelAlign);case 2:200===(a=t.sent).code?(e.$message({type:"success",message:"添加成功"}),e.dialogVisible=!1,e.welfareList()):e.$message({type:"warning",message:a.message});case 4:case"end":return t.stop()}},t,e)}))()},editWelfare:function(){var e=this;return u()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.editWelfare(e.formLabelAlign);case 2:200===(a=t.sent).code?(e.$message({type:"success",message:"添加成功"}),e.dialogVisible=!1,e.welfareList()):e.$message({type:"warning",message:a.message});case 4:case"end":return t.stop()}},t,e)}))()},startWelfare:function(e){this.releaseWelfare(e)},releaseWelfare:function(e){var t=this;return u()(i.a.mark(function a(){var n;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,m.a.releaseWelfare(g.a.stringify({projectId:e}));case 2:200===(n=a.sent).code?(t.$message({type:"success",message:"发布成功"}),t.welfareList()):t.$message({type:"warning",message:n.message});case 4:case"end":return a.stop()}},a,t)}))()},deleteProject:function(e){this.showMessage(e,"delete")},showMessage:function(e,t){var a=this;return u()(i.a.mark(function n(){var r;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=void 0,"end"===t?r="是否结束筹款":"delete"===t&&(r="是否删除该项目"),a.$confirm(r,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){"end"===t?a.endWelfare(e):"delete"===t&&a.deleteData(e)}).catch(function(){a.$message({type:"warning",message:"已取消"})});case 3:case"end":return n.stop()}},n,a)}))()},deleteData:function(e){var t=this;return u()(i.a.mark(function a(){var n;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,m.a.deleteWelfare(g.a.stringify({projectId:e}));case 2:200===(n=a.sent).code?(t.welfareList(),t.$message({type:"success",message:"删除成功!"})):t.$message({type:"success",message:n.message});case 4:case"end":return a.stop()}},a,t)}))()},endProject:function(e){this.showMessage(e,"end")},endWelfare:function(e){var t=this;return u()(i.a.mark(function a(){var n;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,m.a.endWelfare(g.a.stringify({projectId:e}));case 2:200===(n=a.sent).code?(t.welfareList(),t.$message({type:"success",message:"结束筹款!"})):t.$message({type:"warning",message:n.message});case 4:case"end":return a.stop()}},a,t)}))()},changePayStatus:function(){this.pageNum=1,this.welfareList()},editBtn:function(e){this.title="修改公益",this.welfareDetails(e)},welfareDetails:function(e){var t=this;return u()(i.a.mark(function a(){var n;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,m.a.welfareDetails(e);case 2:200===(n=a.sent).code?(t.dialogVisible=!0,t.formLabelAlign=n.data):t.$message({type:"warning",message:n.message});case 4:case"end":return a.stop()}},a,t)}))()},handlePictureCardPreview:function(e){console.log(e),this.dialogImageUrl=e.url,this.dialogVisiblePic=!0},welfareList:function(e){var t=this;return u()(i.a.mark(function a(){var n;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e=e||"",a.next=3,m.a.welfareList({pageNum:t.pageNum,pageSize:t.pageSize,status:t.formInline.payNumber,title:e});case 3:n=a.sent,console.log(n),200===n.code?(t.tableData=n.data.list,t.total=n.data.total):904===n.code?(t.tableData=[],t.total=1):t.$message({type:"warning",message:n.message});case 6:case"end":return a.stop()}},a,t)}))()},handleSizeChange:function(e){this.pageSize=e,this.welfareList()},handleCurrentChange:function(e){this.pageNum=e,this.welfareList()},handleClose:function(){}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"helpFul"},[a("div",[a("div",[[a("header",[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0},model:{value:e.formInline,callback:function(t){e.formInline=t},expression:"formInline"}},[a("el-form-item",{attrs:{label:"项目名称"}},[a("el-input",{attrs:{placeholder:"项目名称"},model:{value:e.formInline.name,callback:function(t){e.$set(e.formInline,"name",t)},expression:"formInline.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"筹款状态"}},[a("el-select",{attrs:{placeholder:"全部"},on:{change:e.changePayStatus},model:{value:e.formInline.payNumber,callback:function(t){e.$set(e.formInline,"payNumber",t)},expression:"formInline.payNumber"}},e._l(e.saveStatus,function(e,t){return a("el-option",{key:t,attrs:{label:e.payName,value:e.payNumber}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("查询")]),e._v(" "),-1!=e.list.indexOf("170")||-1!=e.list.indexOf(170)?a("el-button",{attrs:{type:"primary"},on:{click:e.addSubmit}},[e._v("新增")]):e._e()],1)],1)],1)],e._v(" "),[a("section",[a("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"title",label:"项目名称","min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"targetAmount",label:"目标筹款(元)","min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"currentAmount",label:"当前筹款(元)","min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"releaseTime",label:"筹款时间","min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"募款状态","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.status?a("span",[e._v("筹款中")]):1===t.row.status?a("span",[e._v("已结束")]):a("span",[e._v("未发布")])]}}])}),e._v(" "),-1!=e.list.indexOf("170")||-1!=e.list.indexOf(170)?a("el-table-column",{staticClass:"make",attrs:{label:"操作","min-width":"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.status?a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.endProject(t.row.projectId)}}},[e._v("结束筹款")]):1==t.row.status?a("el-button",{attrs:{type:"text"}},[e._v("已结束")]):a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.startWelfare(t.row.projectId)}}},[e._v("发布")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.editBtn(t.row.projectId)}}},[e._v("编辑")]),e._v(" "),a("el-button",{staticStyle:{color:"red"},attrs:{type:"text",size:"small"},on:{click:function(a){return e.deleteProject(t.row.projectId)}}},[e._v("删除")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"}},[e._v("提交项目进展")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"}},[e._v("提交财务披露")])]}}],null,!1,3781860749)}):e._e()],1)],1)]],2),e._v(" "),[a("footer",[a("div",[a("el-pagination",{attrs:{"current-page":e.pageNum,"page-sizes":[5,10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])]],2),e._v(" "),a("el-dialog",{staticClass:"welfare comom",attrs:{visible:e.dialogVisible,width:"80%",title:e.title},on:{"update:visible":function(t){e.dialogVisible=t},close:e.handleClose}},[[a("el-form",{attrs:{"label-position":"left","label-width":"100px",model:e.formLabelAlign}},[a("el-form-item",{attrs:{label:"项目名称"}},[a("el-input",{model:{value:e.formLabelAlign.title,callback:function(t){e.$set(e.formLabelAlign,"title","string"==typeof t?t.trim():t)},expression:"formLabelAlign.title"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"筹款金额(元)"}},[a("el-input",{model:{value:e.formLabelAlign.targetAmount,callback:function(t){e.$set(e.formLabelAlign,"targetAmount","string"==typeof t?t.trim():t)},expression:"formLabelAlign.targetAmount"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目介绍",prop:"desc"}},[a("el-input",{attrs:{type:"textarea",rows:3},model:{value:e.formLabelAlign.introduce,callback:function(t){e.$set(e.formLabelAlign,"introduce","string"==typeof t?t.trim():t)},expression:"formLabelAlign.introduce"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"项目图片"}},[a("div",{staticClass:"upload"},[a("div",{staticClass:"show"},e._l(e.formLabelAlign.imgs,function(t,n){return a("li",{key:n},[a("div",{staticClass:"img",style:{backgroundImage:"url("+t+")",backgroundSize:"cover"},on:{click:function(a){return e.imgUrl(t)}}}),e._v(" "),a("div",{staticClass:"delete",on:{click:function(a){return e.deleteImg(n,t)}}},[a("i",{staticClass:"el-icon-close"})])])}),0),e._v(" "),a("div",{staticClass:"add"},[a("input",{attrs:{type:"file",id:"upload_file",multiple:""},on:{change:function(t){return e.fileChange(t)}}}),e._v(" "),a("div",[a("i",{staticClass:"el-icon-plus"})])])]),e._v(" "),a("p",[e._v("（注明：最多上传三张,第一张作为项目主图）")])]),e._v(" "),a("el-form-item",{attrs:{label:"项目预算",prop:"desc"}},[a("el-input",{attrs:{type:"textarea",rows:3.5},model:{value:e.formLabelAlign.projectBudget,callback:function(t){e.$set(e.formLabelAlign,"projectBudget","string"==typeof t?t.trim():t)},expression:"formLabelAlign.projectBudget"}})],1),e._v(" "),a("el-form-item",[a("div",{staticClass:"upload"},[a("div",{staticClass:"show"},[""!=e.formLabelAlign.budgetPhoto?a("li",[a("div",{staticClass:"img",style:{backgroundImage:"url("+e.formLabelAlign.budgetPhoto+")",backgroundSize:"cover"},on:{click:function(t){return e.imgUrl(e.formLabelAlign.budgetPhoto)}}})]):e._e()]),e._v(" "),a("div",{staticClass:"add"},[a("input",{attrs:{type:"file",id:"upload_file",multiple:""},on:{change:function(t){return e.singleFileChange(t)}}}),e._v(" "),a("div",[a("i",{staticClass:"el-icon-plus"})])])])]),e._v(" "),a("el-form-item",{attrs:{label:"管理费说明",prop:"desc"}},[a("el-input",{attrs:{type:"textarea",rows:3.5},model:{value:e.formLabelAlign.explain,callback:function(t){e.$set(e.formLabelAlign,"explain","string"==typeof t?t.trim():t)},expression:"formLabelAlign.explain"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"执行计划",prop:"desc"}},[a("el-input",{attrs:{type:"textarea",rows:3.5},model:{value:e.formLabelAlign.implementation,callback:function(t){e.$set(e.formLabelAlign,"implementation","string"==typeof t?t.trim():t)},expression:"formLabelAlign.implementation"}})],1),e._v(" "),a("el-form-item",[a("el-button",{on:{click:e.resetForm}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("保存")])],1)],1)]],2),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.imgStatus,expression:"imgStatus"}],staticClass:"bigImg",on:{click:e.bigImg}},[a("div",[a("img",{attrs:{src:e.imgurl}})])])],1)},staticRenderFns:[]};var v=a("C7Lr")(b,h,!1,function(e){a("PtTQ"),a("b8Ns")},"data-v-5f3a7fa7",null);t.default=v.exports},b8Ns:function(e,t){}});
//# sourceMappingURL=1.e9bd2d282c845b3bb642.js.map